import{r as i,u as B,j as o,s as x}from"./app-PvUrJiW8.js";import{h as j}from"./moment-C5S46NFB.js";import F from"./request-calculation-section-CdcqxIkv.js";import{s as M,a as w}from"./loan-record-thunk-CEJ8FNVp.js";import{B as g}from"./Button-CvjSp1Hx.js";import{D as E}from"./Dialog-BKjxCzi9.js";import{T as f}from"./Toolbar-DVlZWk32.js";import{T as b}from"./TextField-C0GIT-II.js";import{T as y}from"./Typography-BAl_tMc0.js";import"./Close-C9uTtWE1.js";import"./createSvgIcon-YkvDxnXz.js";import"./DefaultPropsProvider-fJ6Czbzk.js";import"./TableRow-BYSNjp-e.js";import"./IconButton-BF3BQisD.js";import"./createSimplePaletteValueFilter-r6HtAYP3.js";import"./Paper-d2hKnMdX.js";import"./useTheme-D9m5OIJo.js";import"./Modal-Cx4lTk_Q.js";import"./ownerDocument-DW-IO8s5.js";import"./ownerWindow-HkKU3E4x.js";import"./useSlot-P_nQH-Vq.js";import"./utils-Bwu84FNj.js";import"./InputBase-BCbeV3nz.js";import"./isHostComponent-DVu5iVWx.js";import"./index-BHHUBmdJ.js";import"./extendSxProp-B_7L_XTA.js";import"./debounce-Be36O1Ab.js";import"./Popover-XOx6CB3K.js";import"./Grow-BqVwvHxR.js";import"./useThemeProps-CYwoh7qI.js";function ue(){const[v,d]=i.useState(!1),[e,n]=i.useState({term:3,desired_amount:null,interest:0,net:0,bi_amortization:0,interest_rate:.05,schedule:[]});i.useState([]);const[t,u]=i.useState({}),[S,m]=i.useState(!1),{user:c}=B(s=>s.app);function C(s,r,p,a){const k=j().date(10),_=[];for(let l=0;l<a;l++){const N=k.clone().add(Math.floor(l/2),"months").date(l%2===0?10:25);_.push({date:N.format("LL"),payment:r.toFixed(2)})}return _}i.useEffect(()=>{const s=C(e.net,e.bi_amortization,e.term,6);n({...e,interest:(e.desired_amount??0)*(e.interest_rate??0)*(e.term??0),net:(e.desired_amount??0)-(e.desired_amount??0)*(e.interest_rate??0)*(e.term??0),bi_amortization:(e.desired_amount??0)/(e.term??1)/2,schedule:s,...c,balance:e.desired_amount})},[(e==null?void 0:e.desired_amount)??""]),console.log("form",e);const T=()=>d(!0),h=()=>d(!1);function D(s){n({...e,[s.target.name]:Number(s.target.value)})}async function z(s){var r,p;try{m(!0);const a=await x.dispatch(M({...e,loan_record_id:j().format("MMDDYYYYHHmmss"),status:"Pending"}));a.status==200?(x.dispatch(w(c.employee_id)),m(!1),d(!1),u({}),n({term:3,desired_amount:0,interest:0,net:0,bi_amortization:0,interest_rate:.05,schedule:[]})):((p=(r=a==null?void 0:a.response)==null?void 0:r.data)!=null&&p.errors?u(a.response.data.errors):(console.log("result",a),u({notification:a.data.response})),m(!1))}catch{m(!1)}}return o.jsxs(i.Fragment,{children:[o.jsx(g,{variant:"outlined",onClick:T,children:"Create Loan Request"}),o.jsxs(E,{fullWidth:!0,open:v,onClose:h,children:[o.jsx(F,{handleClose:h,user:c,form:e,setForm:n}),o.jsxs(f,{className:"flex-col gap-3 flex",children:[(t==null?void 0:t.notification)&&o.jsx("div",{className:"text-red-500",children:t==null?void 0:t.notification}),o.jsx(b,{onChange:s=>n({...e,[s.target.name]:s.target.value}),error:!!(t!=null&&t.purpose),helperText:(t==null?void 0:t.purpose)??"",name:"purpose",type:"text",label:"Purpose of Borrowing",variant:"outlined",fullWidth:!0}),o.jsx(b,{onChange:D,error:!!(t!=null&&t.desired_amount),helperText:(t==null?void 0:t.desired_amount)??"",name:"desired_amount",type:"number",label:"Desired Amount",variant:"outlined",fullWidth:!0})]}),o.jsxs(f,{className:"flex-col",children:[o.jsx(y,{variant:"h6",gutterBottom:!0,children:"Amortization Schedule"}),e.schedule.map((s,r)=>o.jsx(y,{children:o.jsxs("div",{className:"flex items-center justify-between w-96",children:[o.jsxs("div",{children:["Date: ",s.date]}),o.jsxs("div",{children:["Payment: ",e.bi_amortization.toFixed(2)]})]})},r))]}),o.jsx(f,{className:"flex items-end justify-end",children:o.jsx(g,{disabled:S,variant:"contained",onClick:z,children:"SUBMIT"})})]})]})}export{ue as default};
